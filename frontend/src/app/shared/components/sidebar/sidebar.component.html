<nav class="sidebar">
  <div class="sidebar-header">
    <span class="sidebar-title">Navigation</span>
  </div>
  <ul class="nav-list">
    <li>
      <a routerLink="/dashboard" routerLinkActive="active" class="nav-item">
        <span class="nav-icon">üìä</span>
        <span class="nav-label">Dashboard</span>
      </a>
    </li>

    @if (!loaded()) {
      <li class="sidebar-loading">Loading‚Ä¶</li>
    }

    @for (mod of modules(); track mod.ObjNo) {
      <li class="nav-section">
        <button class="nav-section-toggle" (click)="toggleModule(mod.ObjNo)">
          @if (mod.Icon) {
            <i [class]="mod.Icon"></i>
          } @else {
            <span class="nav-icon">üìÅ</span>
          }
          <span class="nav-label">{{ mod.Code }}</span>
          <span class="toggle-arrow" [class.expanded]="isExpanded(mod.ObjNo)">‚ñ∏</span>
        </button>

        @if (isExpanded(mod.ObjNo)) {
          <ul class="nav-sub-list">
            @for (child of getChildren(mod.ObjNo); track child.ObjNo) {
              <li>
                <a
                  [routerLink]="getChildRoute(child)"
                  routerLinkActive="active"
                  class="nav-item sub-item"
                >
                  <span class="nav-label">{{ child.Code }}</span>
                  @if (isErmChild(child)) {
                    <span class="nav-id">({{ child.FormID }})</span>
                  }
                </a>
              </li>
            }
            @if (getChildren(mod.ObjNo).length === 0) {
              <li class="nav-empty">No sub-items</li>
            }
          </ul>
        }
      </li>
    }
  </ul>
</nav>
